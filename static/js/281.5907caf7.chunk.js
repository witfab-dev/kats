"use strict";(self.webpackChunkkirehe_school_website=self.webpackChunkkirehe_school_website||[]).push([[281],{4662(e,t,o){o.d(t,{trackPageView:()=>w});var n=o(9379),i=o(3016);const a={ga4MeasurementId:{NODE_ENV:"production",PUBLIC_URL:"/kats",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_GA4_MEASUREMENT_ID||"G-XXXXXXXXXX",uaTrackingId:{NODE_ENV:"production",PUBLIC_URL:"/kats",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_UA_TRACKING_ID||"UA-XXXXXXXXX-X",facebookPixelId:{NODE_ENV:"production",PUBLIC_URL:"/kats",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_FACEBOOK_PIXEL_ID||"",customAnalyticsEndpoint:{NODE_ENV:"production",PUBLIC_URL:"/kats",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_ANALYTICS_API_URL||"",customApiKey:{NODE_ENV:"production",PUBLIC_URL:"/kats",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_ANALYTICS_API_KEY||"",debug:!1,samplingRate:1},d=()=>{if("1"===navigator.doNotTrack)return!1;return"true"!==localStorage.getItem("analytics_opt_out")&&(!(a.samplingRate<1)||Math.random()<a.samplingRate)},r=()=>{"undefined"!==typeof window&&(console.log("\ud83d\udcca Initializing analytics..."),a.ga4MeasurementId&&s(),a.facebookPixelId&&c(),a.customAnalyticsEndpoint&&l(),console.log("\ud83d\udcca Analytics initialized"))},s=()=>{window.dataLayer||(window.dataLayer=window.dataLayer||[],window.gtag=function(){window.dataLayer.push(arguments)},window.gtag("js",new Date),window.gtag("config",a.ga4MeasurementId,{page_title:document.title,page_location:window.location.href,page_path:window.location.pathname,send_page_view:!1}),a.debug&&console.log("\ud83d\udcca GA4 initialized"))},c=()=>{window.fbq||(window.fbq=function(){window.fbq.callMethod?window.fbq.callMethod.apply(window.fbq,arguments):window.fbq.queue.push(arguments)},window._fbq||(window._fbq=window.fbq),window.fbq.push=window.fbq,window.fbq.loaded=!0,window.fbq.version="2.0",window.fbq.queue=[],window.fbq("init",a.facebookPixelId),window.fbq("track","PageView"),a.debug&&console.log("\ud83d\udcca Facebook Pixel initialized"))},l=()=>{a.debug&&console.log("\ud83d\udcca Custom analytics enabled")},w=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("undefined"===typeof window)return;if(!d())return void(a.debug&&console.log("\ud83d\udcca Tracking skipped (user preference or sampling)"));const o=document.title||"KATSS Website",r=window.location.href,s={page_title:o,page_location:r,page_path:e||window.location.pathname,referrer:document.referrer||"",user_agent:navigator.userAgent,screen_resolution:"".concat(window.screen.width,"x").concat(window.screen.height),timestamp:(new Date).toISOString(),school_name:i.xQ.name,environment:"production"},c=(0,n.A)((0,n.A)({},s),t);try{window.gtag&&a.ga4MeasurementId&&window.gtag("event","page_view",c),window.fbq&&window.fbq("track","PageView"),window.ga&&a.uaTrackingId&&window.ga("send","pageview",e),a.customAnalyticsEndpoint&&await _("page_view",c),a.debug&&console.log("\ud83d\udcca Page view tracked:",{page:e,url:r,title:o,params:c}),g("page_view",c)}catch(l){console.error("\ud83d\udcca Analytics error:",l)}},_=async(e,t)=>{if(a.customAnalyticsEndpoint)try{const o=await fetch(a.customAnalyticsEndpoint,{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(a.customApiKey),"X-API-Key":a.customApiKey},body:JSON.stringify({type:e,data:t,timestamp:(new Date).toISOString(),source:"web",version:"1.0"})});if(!o.ok)throw new Error("Analytics API error: ".concat(o.status));return await o.json()}catch(o){console.error("\ud83d\udcca Custom analytics error:",o),u(e,t,o.message)}};const g=(e,t)=>{if("undefined"!==typeof window)try{const o=JSON.parse(localStorage.getItem("analytics_offline_events")||"[]");o.push({type:e,data:t,stored_at:(new Date).toISOString()}),o.length>100&&o.splice(0,o.length-100),localStorage.setItem("analytics_offline_events",JSON.stringify(o))}catch(o){console.error("\ud83d\udcca Failed to store offline event:",o)}},u=(e,t,o)=>{if("undefined"!==typeof window)try{const n=JSON.parse(localStorage.getItem("analytics_failed_events")||"[]");n.push({type:e,data:t,error:o,failed_at:(new Date).toISOString()}),localStorage.setItem("analytics_failed_events",JSON.stringify(n))}catch(o){}},S=async()=>{if("undefined"!==typeof window)try{const t=JSON.parse(localStorage.getItem("analytics_failed_events")||"[]");if(0===t.length)return;const o=[];for(const i of t)try{await _(i.type,i.data),o.push(i)}catch(e){}const n=t.filter(e=>!o.includes(e));localStorage.setItem("analytics_failed_events",JSON.stringify(n)),a.debug&&console.log("\ud83d\udcca Retried ".concat(o.length," events, ").concat(n.length," remain"))}catch(e){console.error("\ud83d\udcca Failed to retry events:",e)}};"undefined"!==typeof window&&setTimeout(()=>{r(),S(),setInterval(S,3e5)},1e3)}}]);
//# sourceMappingURL=281.5907caf7.chunk.js.map